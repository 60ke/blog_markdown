---
title: python2之django前端中文乱码中文
date: 2017-09-25 01:53:33
categories: python
tags: []
urlname: 69
---
把爬取到的数据用于前端展示的时候，结果发现之前的前端存在中文乱码的情况，于是开始了2，3天的debug之旅。。。。
---------------------------------------------------------
现象：
前端echarts展示的数据，英文，数字正常显示，中文乱码。
排查：
先查看了网页源码中乱码的不部分，之后进一步确定目录` templates`下的`carousel.html`中script的`data`字典的值`{{ tag_cwe | safe }`乱码，之后得知`{{ tag_cwe | safe }`在视图`views.py`中运行`django`的shell调试输出结合网页源码确定bug的原因：
    django从数据库获取的数据为中文，而python2中文是以bytes形式存储的。例如
    a = "我"
    a
    '\xce\xd2'
    而前端无法解析`'\xce\xd2'`故而乱码
尝试解决：
1.将数据转换为`utf-8`编码之后传至前端
    结果：失败。原因：python2对于str类型的数据加有前缀`u'`，导致前端无法解析
2.将数据以base64编码，再有前端解码
    结果：成功


## 后记 ##
现在描述起来只有一二百字，但是解决的过程还是相当的扯淡，需要去了解django的架构，以及部分前端，然后！去，踩python2的坑。。。